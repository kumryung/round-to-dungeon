# Project: Round the Dungeon (Web Prototype)

## 1. 프로젝트 개요
**Round to Dungeon**은 부루마블(보드게임) 형식의 맵 이동과 턴제 RPG 전투, 그리고 다크 판타지 요소가 결합된 웹 기반 로그라이크 게임입니다. 플레이어는 길드에서 방랑자를 영입하고, 마을에서 정비한 뒤, 각종 몬스터와 함정, 무작위 이벤트가 도사리는 던전을 탐험하며 장비를 제작하고 생존하는 것이 목표입니다.

### 기술 스택
- **번들러**: Vite
- **언어**: Vanilla JavaScript (ES Modules)
- **스타일**: Vanilla CSS
- **배포**: 정적 빌드 (`npx vite build`)

### 빌드 및 실행 방법
```bash
npm install
npm run dev       # 개발 서버 (http://localhost:5173)
npx vite build    # 프로덕션 빌드
```

---

## 2. 핵심 게임플레이 루프 (Core Gameplay Loop)
1. **마을 정비 (Town Phase)**
   * **길드(Guild)**: 새로운 방랑자를 영입해 로스터를 구성합니다.
   * **창고(Storage)**: 던전에서 가져온 아이템을 보관하고 정렬합니다. 무게 관리를 위해 필수적입니다.
   * **대장간(Forge)**: 파밍한 재료들로 더 높은 등급의 장비를 크래프팅합니다.
   * **상점(Shop)**: 매시간 갱신되는 장비와 소모품을 구매하거나, 가챠(Draw)를 통해 운을 시험합니다.
   * **우편함(Mailbox)**: 창고가 가득 차 던전에서 다 챙기지 못한 아이템을 수취합니다.

2. **던전 탐험 (Dungeon Phase)**
   * **주사위 스폰 (Spawn Phase)**: 맵 진입 시 3개의 주사위를 굴려 몬스터, 보물상자, 이벤트를 무작위로 타일에 배치합니다.
   * **이동 (Move Phase)**: 이동 주사위를 굴려 맵을 전진합니다. 이동할 때마다 지속적으로 **정신력(Sanity)**이 소모되며, 과도한 **무게(Weight)**를 들고 있을 시 주사위 눈금이 제한됩니다.
   * **상호작용 (Action Phase)**: 도착한 타일의 오브젝트(몬스터 전투, 상자 개방, 복합 이벤트 선택지)와 상호작용합니다.
   * **웨이브 진행**: 맵을 한 바퀴 돌아 시작 지점으로 돌아갈 때마다 웨이브가 오르고, 몬스터가 점차 강력해집니다.

---

## 3. 주요 시스템 명세 (System Specifications)

### 3.1. 다국어 지원 (i18n)
* **한국어(ko)**, **영어(en)**, **일본어(ja)** 3개 국어를 100% 지원합니다.
* 환경 설정(Settings) 탭에서 실시간으로 언어 전환이 가능하며, 게임 내 텍스트, 아이템, 몬스터, 이벤트 로그 등이 모두 동기화되어 즉각 번역됩니다.

### 3.2. ATB (Active Time Battle) 턴제 전투
* 단순한 턴 교환 방식이 아닌, 플레이어와 몬스터의 **민첩성(SPD)** 속도에 비례해 차오르는 **액션 게이지(ATB Bar)** 시스템을 차용했습니다.
* **부위별 타격**: 적의 머리, 몸통, 다리 중 하나를 타겟팅할 수 있으며, 각 부위마다 적중률과 데미지 배율이 다르게 책정되어 있어 전략적인 선택이 필요합니다.

### 3.3. 심화 RPG 패널티 시스템
* **정신력 (Sanity) 시스템**: 탐험이 지속되거나 끔찍한 이벤트를 겪으면 정신력이 깎입니다. 정신력 수치에 따라 광명부터 패닉까지 상태가 나뉘며, 낮아질수록 전투 명중률과 회피율에 치명적인 페널티가 부여됩니다. 엘릭서나 횃불(감소 방지) 아이템으로 관리해야 합니다.
* **무게 (Weight) 시스템**: 방랑자의 **근력(STR)** 스탯에 따라 들 수 있는 최대 무게 한도가 결정됩니다. 한도를 초과하면 이동 주사위 최대값이 대폭 깎여 맵을 빠져나가기 힘들어집니다.
* **장비 착용 조건**: 강력한 장비는 특정 직업(Class)이나 요구 스탯(Reqs)을 달성해야만 착용이 가능합니다.

### 3.4. 상태이상 & 90+ 다이내믹 이벤트
* **상태이상 (Status Effects)**: 전투 중이나 함정 이벤트 보상으로 독, 화상, 출혈, 골절 등의 지속성 디버프나 재생, 횃불 버프를 얻을 수 있습니다. 맵을 한 칸 이동할 때마다 턴이 차감됩니다.
* **이벤트 상호작용**: 단순히 텍스트만 나오는 것이 아니라, 90여 종 이상의 상황별 이벤트(테마 전용 이벤트 포함)가 존재합니다. 플레이어가 삽, 성수, 자물쇠 따개 등의 아이템을 사용해 숨계진 보상을 찾거나, 위험을 감수하는 등의 **선택지**가 주어집니다.

### 3.5. 시각 및 청각 효과 엔진 (VFX & Sound Engine)
* **Web Audio API**: 외부 음원 파일을 다운로드하지 않고, 브라우저 내장 오실레이터(Oscillator)를 통해 공격음, 피격음, 주사위, 파밍, 마우스 클릭 효과음 등 8비트 레트로 사운드를 100% 절차적으로 합성해 냅니다.
* **VFX**: 치명타 발생, 피격, 글리치 텍스트, 화면 흔들림(Screen Shake), 데미지 붉은 점멸 등 CSS와 JS를 결합한 역동적인 시각 피드백을 구현합니다.

---

## 4. 프로젝트 구조

```
src/
├── main.js                     # 엔트리 + 씬 등록 + Audio Warmup
├── sceneManager.js             # 씬(화면) 전환 관리 로직
├── mapEngine.js                # 사각형 보드 맵 생성 및 렌더링
├── dungeonState.js             # 던전 런타임 상태 (이동/상태이상/정신력 계산)
├── combatEngine.js             # ATB 전투 수학 로직 연산
├── combatOverlay.js            # 전투 UI 화면 렌더링
├── inventory.js                # 인벤토리 로직 및 장착 조건(Reqs), 무게(Weight) 연산
├── craftingOverlay.js          # 대장간 조합 및 제작 UI 로직
├── soundEngine.js              # Web Audio API 기반 효과음 합성 엔진
├── vfxEngine.js                # 화면 흔들림 및 점멸 등 시각효과 유틸
├── i18n.js                     # 다국어 처리 시스템
├── gameState.js                # 전역 게임 상태 (소지금, 마을 레벨, 언어설정 보존)
├── locales/                    # 다국어 번역 파일 폴더 (en.js, ko.js, ja.js)
├── data/                       # 방대한 정적 게임 데이터 폴더
│   ├── settings.js             # 밸런스 및 수치 조정 설정값
│   ├── monsters.js             # 몬스터 도감
│   ├── weapons.js              # 무기 데이터
│   ├── items.js                # 소모품/도구/재료 및 드롭 테이블
│   ├── events.js               # 90+ 인터랙티브 선택지 이벤트 풀
│   ├── recipes.js              # 장비 크래프팅 레시피 조합식
│   ├── maps.js                 # 각 던전별 모듈 구성 및 테마
│   └── wanderers.js            # 방랑자(캐릭터) 프리셋
├── scenes/
│   ├── titleScene.js           # 타이틀 메인 화면
│   ├── townScene.js            # 마을 메뉴 (길드, 창고, 대장간, 상점 등 탭 내비게이션 관리)
│   └── dungeonScene.js         # 주사위 보드 로직이 도는 던전 탐색 씬
└── style.css                   # 다크/고딕 판타지 풍의 전역 UI 스타일 (CSS)
```

---

## 5. UI/UX 상세 요구사항 (Detailed UI Specifications)

* **프리미엄 고딕 테마 연출**: 어둡고 묵직한 배경색과 골드/레드 라인의 조화, 네온 글리치 효과, 다양한 프로그레스 바(HP, Sanity, 경험치) 디자인 통일성 강화.
* **마을 (Town Navigation)**: 하단 탭 바(Tab Bar)를 통해 성, 길드, 창고, 대장간, 상점, 우편함, 환경설정, 던전 진입 등 다양한 메뉴를 직관적으로 오가며 관리. 아이템 드래그 앤 드롭 지원.
* **전장 플레이보드 (Dungeon Board)**:
  * 반응형 Grid로 디스플레이 크기에 맞게 보드판이 생성 및 리사이징됩니다 (모바일, 태블릿 완벽 호환).
  * 맵별 특성(forest, mine, swamp, citadel 등)에 따른 컬러 팔레트가 보드판에 입혀집니다.
* **장착 시스템 피드백**: 장비가 요구하는 스탯이 미달될 시 색상 알림(붉음) 및 착용 불가 툴팁으로 원인을 직관적으로 제공하며, 장비 간 스탯 비교가 쉽게 컬러 칩을 표시합니다.
* **상태 보존 기술 (Persistence)**: 전투 도중이나 던전 이동 중에 브라우저를 닫거나 새로고침해도 현재 턴, 적 HP, 이동 페이즈 데이터가 로컬 스토리지에 자동 백업되어 탐험이 중단되지 않습니다.


## 9. AI Agent 참고 사항
* 답변은 최대한 간결하게 하며, 최종 답변은 항상 한국어로 한다.



# 전투시 틱 다는 상태

몬스터(박쥐) - 9틱
방랑자 : 10틱

1. 몬스터가 먼저 공격한다.
몬스터 0틱 , 방랑자 10틱

2. 몬스터가 공격한다.
몬스터 0틱 , 방랑자 1틱

3. 방랑자가 공격한다.
몬스터 9틱 , 방랑자 0틱

4. 몬스터가 공격한다
몬스터 0틱 , 방랑자 2틱